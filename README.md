# Hello World Web Application

## Overview
This project demonstrates the deployment of a simple web application that retrieves "Hello World" from a Cloud SQL database using Google Cloud Functions with Node.js. The infrastructure is managed using Terraform. The application code is stored in Cloud Storage.

## Services Used

### Cloud SQL
- **Purpose**: Used as the database backend for the application.
- **Actions Taken**: A Cloud SQL instance is created to host the database. A SQL user and database are created to handle application data.

### Cloud Functions
- **Purpose**: Executes the Node.js application code to retrieve data from the Cloud SQL database and render "Hello World".
- **Actions Taken**: A Cloud Function is deployed to execute the Node.js application code. The function is connected to the Cloud SQL instance using a service account for database access.

### Cloud Storage
- **Purpose**: Stores the application code that is deployed to Cloud Functions.
- **Actions Taken**: The application code (Node.js files) are stored in Cloud Storage buckets for deployment to Cloud Functions.

### VPC
- **Purpose**: Provides networking isolation and security for the Cloud Function.
- **Actions Taken**: The Cloud Function is provisioned within a VPC to ensure secure communication within the virtual network.

### APIs Enabled
- **Purpose**: Enables necessary Google Cloud APIs required for the project.
- **Actions Taken**: The required APIs, such as Cloud SQL, Cloud Functions, Cloud Storage, and VPC, are enabled to facilitate the deployment and operation of the application.

## Setup
Follow these steps to set up and deploy the application:

1. **Set Up Environment Variables**: 
    - Replace the placeholders in the commands below with your specific values.
    ```bash
    export TF_VAR_project_id="your-gcp-project-id"
    export TF_VAR_db_user="your-db-user"
    export TF_VAR_db_password="your-db-password"
    export GOOGLE_APPLICATION_CREDENTIALS="/path/to/your/service-account-key.json"
    ```
    Replace `/path/to/your/service-account-key.json` with the path to your service account key file.

2. **Navigate to Your App Folder**: 
    - Open your terminal or command prompt and navigate to the directory where your app folder is located using the `cd` command.

3. **Install Dependencies**: 
    - Run `npm install` to install all the dependencies listed in your `package.json` file.

4. **Zip All the Files**: 
    - Use a command-line tool like `zip` (for Unix-based systems) or PowerShell (for Windows) to zip all the files in the folder.
    - For Unix-based systems (Linux, macOS):
        ```bash
        zip -r function-source.zip index.js package.json node_modules
        ```
      This command recursively zips all the files and directories in the current folder into a file named `function-source.zip`. The `-r` flag stands for recursive, which includes all subdirectories and their contents.

5. **Verify the Zip File**: 
    - Once the command completes, you should have a `function-source.zip` file in your current directory containing all your app files and dependencies.

6. **Perform Terraform Commands to Deploy Application**: 
    - Run `terraform init`: This command initializes the Terraform configuration, initializing the working directory and downloading all required plugins. It's the first step before applying any changes.
    - Run `terraform plan`: This command generates an execution plan, displaying what actions Terraform will take to change the infrastructure. It's a useful step to review changes before applying them.
    - Run `terraform apply`: This command applies the changes required to reach the desired state of the configuration, creating the necessary infrastructure resources. Make sure to review the plan generated by `terraform plan` before applying to avoid unexpected changes.

7. **View Outputs and Function URL**:
    - After successfully applying the Terraform configuration using `terraform apply`, you can view the outputs generated by Terraform.
    - Run `terraform output`: This command displays the outputs defined in your Terraform configuration. Among these outputs, you should see the URL of your deployed function along with any other relevant information about the created resources.
    - Note down the function URL provided in the output. This URL can be used to access your deployed web application.

## Application Logic
The Node.js application code connects to the Cloud SQL database and validates the existence of the "hello_world" table. If the table does not exist, it creates the table and inserts the "Hello World" message into it. The application then renders the "Hello World" message from the database onto the `index.html` page.

